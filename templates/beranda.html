<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OWEN - Organic Waste Energy</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Poppins", sans-serif;
        background-color: #f3f4f6;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      @keyframes slideInBottomBounce {
        0% {
          opacity: 0;
          transform: translateY(50px);
        }
        60% {
          transform: translateY(-10px);
        }
        80% {
          transform: translateY(5px);
        }
        100% {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes slideInBottom {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }

      @keyframes wobble {
        0% {
          transform: translateX(0%);
        }
        15% {
          transform: translateX(-5%) rotate(-5deg);
        }
        30% {
          transform: translateX(5%) rotate(3deg);
        }
        45% {
          transform: translateX(-5%) rotate(-3deg);
        }
        60% {
          transform: translateX(5%) rotate(2deg);
        }
        75% {
          transform: translateX(-2%) rotate(-1deg);
        }
        100% {
          transform: translateX(0%);
        }
      }

      .animate-slideInBottomBounce {
        animation: slideInBottomBounce 0.5s ease-out forwards;
      }

      .grid-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
        margin-bottom: 16px;
      }

      .value-fade {
        transition: opacity 0.3s ease-in-out;
        opacity: 1;
      }

      .value-fade.fade-out {
        opacity: 0.5;
      }
    </style>
  </head>

  <body class="bg-gray-100 min-h-screen flex flex-col">
    <div class="bg-green-600 p-4 flex items-center justify-between shadow-md">
      <div></div>

      <div class="logo">
        <img src="/static/owenn.png" alt="Logo OWEN" class="w-24" />
      </div>

      <div></div>
    </div>

    <div
      class="container max-w-md mx-auto p-6 flex-1 flex flex-col justify-between"
    >
      <div class="content flex-grow space-y-4">
        <h6 class="text-xl font-semibold text-gray-800 mb-2">Selamat Datang</h6>

        <h6 class="text-2xl font-bold text-green-600 mb-6">
          Status Sistem Hari Ini!
        </h6>

        <div class="grid-container">
          <div
            class="bg-white shadow rounded-md p-4 transition duration-200 ease-in-out hover:shadow-lg animate-slideInBottom flex flex-col items-center justify-center"
            style="animation-delay: 0.1s"
          >
            <span
              class="text-3xl font-bold text-green-600 value-fade"
              id="suhu-value"
              >- Â°C</span
            >
            <div class="flex items-center gap-2 mt-1">
              <span class="text-xl">ğŸŒ¡ï¸</span>
              <span class="font-medium text-gray-700 text-sm">Suhu</span>
            </div>
          </div>

          <div
            class="bg-white shadow rounded-md p-4 transition duration-200 ease-in-out hover:shadow-lg animate-slideInBottom flex flex-col items-center justify-center"
            style="animation-delay: 0.3s"
          >
            <span
              class="text-3xl font-bold text-green-600 value-fade"
              id="kelembaban-value"
              >- %</span
            >
            <div class="flex items-center gap-2 mt-1">
              <span class="text-xl">ğŸ’§</span>
              <span class="font-medium text-gray-700 text-sm">Kelembaban</span>
            </div>
          </div>

          <div
            class="bg-white shadow rounded-md p-4 transition duration-200 ease-in-out hover:shadow-lg animate-slideInBottom flex flex-col items-center justify-center"
            style="animation-delay: 0.5s"
          >
            <span
              class="text-3xl font-bold text-green-600 value-fade"
              id="tegangan-value"
              >- V</span
            >
            <div class="flex items-center gap-2 mt-1">
              <span class="text-xl">âš¡</span>
              <span class="font-medium text-gray-700 text-sm">Tegangan</span>
            </div>
          </div>

          <div
            class="bg-white shadow rounded-md p-4 transition duration-200 ease-in-out hover:shadow-lg animate-slideInBottom flex flex-col items-center justify-center"
            style="animation-delay: 0.7s"
          >
            <span
              class="text-3xl font-bold text-green-600 value-fade"
              id="turbidity-value"
              >- NTU</span
            >
            <div class="flex items-center gap-2 mt-1">
              <span class="text-xl">ğŸŒ«ï¸</span>
              <span class="font-medium text-gray-700 text-sm">Kekeruhan</span>
            </div>
          </div>
        </div>

        <div
          class="bg-white shadow rounded-md p-4 transition duration-200 ease-in-out hover:shadow-lg animate-slideInBottom"
          style="animation-delay: 0.9s"
        >
          <div class="flex justify-between items-center">
            <div class="flex items-center gap-2">
              <span class="text-xl">ğŸ§ª</span>
              <span class="font-medium text-gray-700">pH</span>
            </div>
            <span id="ph-value" class="font-bold text-green-600 value-fade"
              >-</span
            >
          </div>
        </div>

        <div
          class="bg-white shadow rounded-md p-4 transition duration-200 ease-in-out hover:shadow-lg animate-slideInBottom"
          style="animation-delay: 1.1s"
        >
          <div class="flex justify-between items-center">
            <div class="flex items-center gap-2">
              <span class="text-xl">ğŸ’¨</span>
              <span class="font-medium text-gray-700">Kipas</span>
            </div>
            <div
              class="flex items-center gap-2 transition duration-300 ease-in-out"
            >
              <span
                id="kipas-status"
                class="font-bold text-gray-700 value-fade"
              ></span>
              <div
                id="kipas-indicator"
                class="w-3 h-3 rounded-full bg-gray-400 transition duration-300 ease-in-out"
              ></div>
            </div>
          </div>
        </div>

        <div
          class="bg-white shadow rounded-md p-4 transition duration-200 ease-in-out hover:shadow-lg animate-slideInBottom"
          style="animation-delay: 1.3s"
        >
          <div class="flex justify-between items-center">
            <div class="flex items-center gap-2">
              <span class="text-xl">ğŸ—‘ï¸</span>
              <span class="font-medium text-gray-700">Auto Buang</span>
            </div>
            <div
              class="flex items-center gap-2 transition duration-300 ease-in-out"
            >
              <span
                id="auto-buang-status"
                class="font-bold text-gray-700 value-fade"
              ></span>
              <div
                id="auto-buang-indicator"
                class="w-3 h-3 rounded-full bg-gray-400 transition duration-300 ease-in-out"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="navigation bg-green-600 py-2 rounded-md shadow">
      <div class="flex justify-around items-center">
        <a
          href="{{ url_for('index') }}"
          class="text-white transition duration-200 ease-in-out hover:scale-110 hover:animate-wobble"
        >
          <div class="flex flex-col items-center">
            <span class="text-xl">ğŸ </span>
            <span class="text-xs">Beranda</span>
          </div>
        </a>

        <a
          href="{{ url_for('menu') }}"
          class="text-white transition duration-200 ease-in-out hover:scale-110 hover:animate-wobble"
        >
          <div class="flex flex-col items-center">
            <span class="text-xl">ğŸ“Š</span>
            <span class="text-xs">Menu</span>
          </div>
        </a>

        <a
          href="{{ url_for('notif') }}"
          class="text-white transition duration-200 ease-in-out hover:scale-110 hover:animate-wobble"
        >
          <div class="flex flex-col items-center">
            <span class="text-xl">ğŸ””</span>
            <span class="text-xs">Notifikasi</span>
          </div>
        </a>

        <a
          href="{{ url_for('profil') }}"
          class="text-white transition duration-200 ease-in-out hover:scale-110 hover:animate-wobble"
        >
          <div class="flex flex-col items-center">
            <span class="text-xl">ğŸ‘¤</span>
            <span class="text-xs">Profil</span>
          </div>
        </a>
      </div>
    </div>

    <script>
      function updateSensorValue(elementId, newValue, unit = "") {
        const element = document.getElementById(elementId);
        element.classList.add("fade-out");
        setTimeout(() => {
          element.textContent = Math.round(newValue) + unit;
          element.classList.remove("fade-out");
        }, 300); // Durasi animasi fade-out
      }

      function updateData() {
        fetch("/latest_data")
          .then((response) => response.json())
          .then((data) => {
            updateSensorValue("suhu-value", data.suhu, " Â°C");
            updateSensorValue("kelembaban-value", data.kelembaban, " %");
            updateSensorValue("tegangan-value", data.tegangan, " V");
            updateSensorValue("turbidity-value", data.turbidity, " %");

            const phElement = document.getElementById("ph-value");
            phElement.classList.add("fade-out");
            setTimeout(() => {
              phElement.textContent = data.ph !== null ? data.ph : "-";
              phElement.classList.remove("fade-out");
            }, 300);

            const kipasStatusElement = document.getElementById("kipas-status");
            kipasStatusElement.classList.add("fade-out");
            setTimeout(() => {
              kipasStatusElement.textContent = data.kipas
                ? "Aktif"
                : "Tidak Aktif";
              kipasStatusElement.classList.remove("fade-out");
            }, 300);
            document
              .getElementById("kipas-indicator")
              .classList.toggle("bg-green-500", data.kipas);
            document
              .getElementById("kipas-indicator")
              .classList.toggle("bg-gray-400", !data.kipas);

            const autoBuangStatusElement =
              document.getElementById("auto-buang-status");
            autoBuangStatusElement.classList.add("fade-out");
            setTimeout(() => {
              autoBuangStatusElement.textContent = data.auto_buang
                ? "Aktif"
                : "Tidak Aktif";
              autoBuangStatusElement.classList.remove("fade-out");
            }, 300);
            document
              .getElementById("auto-buang-indicator")
              .classList.toggle("bg-green-500", data.auto_buang);
            document
              .getElementById("auto-buang-indicator")
              .classList.toggle("bg-gray-400", !data.auto_buang);
          })
          .catch((error) => {
            console.error("Gagal mengambil data:", error);
          });
      }

      setInterval(updateData, 10000);
      updateData();
    </script>
  </body>
</html>
